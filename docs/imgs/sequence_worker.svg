<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="524px" preserveAspectRatio="none" style="width:544px;height:524px;" version="1.1" viewBox="0 0 544 524" width="544px" zoomAndPan="magnify"><defs><filter height="300%" id="f7j6zz4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="419.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="36.5" y="48.2969"/><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="56.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="184.5" y="69.2969"/><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="56.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="184.5" y="254.9609"/><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="56.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="184.5" y="411.4922"/><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="227.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="452.5" y="154.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="41" x2="41" y1="38.2969" y2="485.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="189.5" x2="189.5" y1="38.2969" y2="485.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="457" x2="457" y1="38.2969" y2="485.7578"/><rect fill="#FEFECE" filter="url(#f7j6zz4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="15" y="22.9951">Worker</text><rect fill="#FEFECE" filter="url(#f7j6zz4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="8" y="484.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="15" y="504.7529">Worker</text><rect fill="#FEFECE" filter="url(#f7j6zz4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="153.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="160.5" y="22.9951">Storage</text><rect fill="#FEFECE" filter="url(#f7j6zz4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="153.5" y="484.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="160.5" y="504.7529">Storage</text><rect fill="#FEFECE" filter="url(#f7j6zz4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="113" x="399" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="406" y="22.9951">LocalTopology</text><rect fill="#FEFECE" filter="url(#f7j6zz4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="113" x="399" y="484.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="406" y="504.7529">LocalTopology</text><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="419.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="36.5" y="48.2969"/><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="56.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="184.5" y="69.2969"/><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="56.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="184.5" y="254.9609"/><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="56.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="184.5" y="411.4922"/><rect fill="#FFFFFF" filter="url(#f7j6zz4)" height="227.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="452.5" y="154.5625"/><polygon fill="#A80036" points="172.5,65.2969,182.5,69.2969,172.5,73.2969,176.5,69.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="46.5" x2="178.5" y1="69.2969" y2="69.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="53.5" y="64.3638">getMessages</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="194.5" x2="236.5" y1="98.5625" y2="98.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="236.5" y1="98.5625" y2="111.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195.5" x2="236.5" y1="111.5625" y2="111.5625"/><polygon fill="#A80036" points="205.5,107.5625,195.5,111.5625,205.5,115.5625,201.5,111.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="201.5" y="93.4966">retrieve list of message for this worker</text><polygon fill="#A80036" points="57.5,121.5625,47.5,125.5625,57.5,129.5625,53.5,125.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="51.5" x2="188.5" y1="125.5625" y2="125.5625"/><polygon fill="#A80036" points="440.5,150.5625,450.5,154.5625,440.5,158.5625,444.5,154.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="46.5" x2="446.5" y1="154.5625" y2="154.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="53.5" y="149.6294">start</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="462.5" x2="504.5" y1="183.8281" y2="183.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="504.5" x2="504.5" y1="183.8281" y2="196.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463.5" x2="504.5" y1="196.8281" y2="196.8281"/><polygon fill="#A80036" points="473.5,192.8281,463.5,196.8281,473.5,200.8281,469.5,196.8281" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="469.5" y="178.7622">run</text><polygon fill="#A80036" points="57.5,221.8281,47.5,225.8281,57.5,229.8281,53.5,225.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="51.5" x2="451.5" y1="225.8281" y2="225.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="63.5" y="220.895">success</text><polygon fill="#A80036" points="172.5,250.9609,182.5,254.9609,172.5,258.9609,176.5,254.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="46.5" x2="178.5" y1="254.9609" y2="254.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="53.5" y="250.0278">setTopologyStatus</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="194.5" x2="236.5" y1="284.2266" y2="284.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="236.5" y1="284.2266" y2="297.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195.5" x2="236.5" y1="297.2266" y2="297.2266"/><polygon fill="#A80036" points="205.5,293.2266,195.5,297.2266,205.5,301.2266,201.5,297.2266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="201.5" y="279.1606">mark topology as running</text><polygon fill="#A80036" points="57.5,307.2266,47.5,311.2266,57.5,315.2266,53.5,311.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="51.5" x2="188.5" y1="311.2266" y2="311.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="462.5" x2="504.5" y1="340.3594" y2="340.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="504.5" x2="504.5" y1="340.3594" y2="353.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463.5" x2="504.5" y1="353.3594" y2="353.3594"/><polygon fill="#A80036" points="473.5,349.3594,463.5,353.3594,473.5,357.3594,469.5,353.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="469.5" y="335.2935">loop spouts</text><polygon fill="#A80036" points="57.5,378.3594,47.5,382.3594,57.5,386.3594,53.5,382.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="51.5" x2="456.5" y1="382.3594" y2="382.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="63.5" y="377.4263">exit/error</text><polygon fill="#A80036" points="172.5,407.4922,182.5,411.4922,172.5,415.4922,176.5,411.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="46.5" x2="178.5" y1="411.4922" y2="411.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="53.5" y="406.5591">setTopologyStatus</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="194.5" x2="236.5" y1="440.7578" y2="440.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="236.5" y1="440.7578" y2="453.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195.5" x2="236.5" y1="453.7578" y2="453.7578"/><polygon fill="#A80036" points="205.5,449.7578,195.5,453.7578,205.5,457.7578,201.5,453.7578" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="201.5" y="435.6919">mark topology as stopped/error</text><polygon fill="#A80036" points="52.5,463.7578,42.5,467.7578,52.5,471.7578,48.5,467.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="46.5" x2="188.5" y1="467.7578" y2="467.7578"/><!--
@startuml
activate Worker
Worker -> Storage: getMessages
activate Storage

Storage -> Storage: retrieve list of message for this worker
Storage - -> Worker:
deactivate Storage

Worker->LocalTopology: start
activate LocalTopology
LocalTopology->LocalTopology: run
LocalTopology- ->Worker: success

Worker -> Storage: setTopologyStatus
activate Storage
Storage -> Storage: mark topology as running
Storage - -> Worker:
deactivate Storage

LocalTopology->LocalTopology: loop spouts

LocalTopology->Worker: exit/error
deactivate LocalTopology

Worker -> Storage: setTopologyStatus
activate Storage
Storage -> Storage: mark topology as stopped/error
Storage - -> Worker:
deactivate Storage

deactivate Worker
@enduml

PlantUML version 2017.09(Wed Apr 05 16:07:11 UTC 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>